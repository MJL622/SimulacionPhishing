<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Taller de Seguridad Digital</title>
    <style>
        /* (todo el CSS permanece igual, omitido para ahorrar espacio) */
        /* Puedes volver a pegar el CSS si lo necesitas completo */
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Taller de Seguridad Digital</h1>
        </div>
    </header>

    <div class="container">
        <!-- Login Section -->
        <div id="login-section" class="login-container">
            <h2>Bienvenido al material de la charla</h2>
            <p>Por favor ingrese sus credenciales para continuar</p>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">Usuario</label>
                    <input type="text" id="username" name="username" required />
                </div>
                <div class="form-group">
                    <label for="password">Contraseña</label>
                    <input type="password" id="password" name="password" required />
                </div>
                <button type="submit" class="btn">Ingresar</button>
            </form>
        </div>

        <!-- Educational Content -->
        <div id="educational-content" class="educational-content">
            <h2>¿Qué es el Phishing?</h2>
            <div class="info-card">
                <p>El phishing es un tipo de ciberataque que utiliza engaños para obtener información confidencial como nombres de usuario, contraseñas y detalles de tarjetas de crédito, haciéndose pasar por una entidad confiable en una comunicación electrónica.</p>
            </div>
            <h2>Ciberseguridad</h2>
            <div class="warning-card">
                <p>La ciberseguridad se refiere a la práctica de proteger sistemas, redes y programas de ataques digitales.</p>
            </div>
            <h2>Cómo protegerse</h2>
            <ul style="margin-left: 20px; margin-bottom: 20px;">
                <li>Nunca ingrese sus credenciales en páginas sospechosas</li>
                <li>Verifique siempre la URL del sitio web</li>
                <li>Use autenticación de dos factores</li>
                <li>Mantenga su software actualizado</li>
            </ul>
            <div class="nav-buttons">
                <button id="admin-btn" class="btn btn-danger">Panel de administración</button>
                <button id="back-btn" class="btn">Volver al inicio</button>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="admin-panel" class="admin-panel">
            <h2>Registros capturados</h2>
            <p>Esta página muestra la información recopilada de los usuarios que ingresaron sus credenciales.</p>
            <table id="user-data">
                <thead>
                    <tr>
                        <th>Usuario</th>
                        <th>Contraseña</th>
                        <th>Fecha</th>
                        <th>Navegador</th>
                        <th>IP</th>
                        <th>Idioma</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div class="nav-buttons">
                <button id="return-btn" class="btn">Volver a la información</button>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>Taller educativo sobre seguridad digital - © 2025</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loginForm = document.getElementById('login-form');
            const loginSection = document.getElementById('login-section');
            const educationalContent = document.getElementById('educational-content');
            const adminPanel = document.getElementById('admin-panel');
            const adminBtn = document.getElementById('admin-btn');
            const backBtn = document.getElementById('back-btn');
            const returnBtn = document.getElementById('return-btn');
            const userDataTable = document.getElementById('user-data').getElementsByTagName('tbody')[0];

            let capturedData = [];
            let userIP = 'Cargando...';

            // Obtener IP pública del usuario
            async function getIP() {
                try {
                    const response = await fetch('https://api.ipify.org?format=json');
                    const data = await response.json();
                    userIP = data.ip;
                } catch (error) {
                    console.error('Error al obtener la IP:', error);
                    userIP = 'No disponible';
                }
            }

            getIP();

            // Función para identificar el navegador
            function detectarNavegador() {
                const userAgent = navigator.userAgent;

                if (userAgent.includes("Chrome") && !userAgent.includes("Edg") && !userAgent.includes("OPR")) {
                    return "Google Chrome";
                } else if (userAgent.includes("Firefox")) {
                    return "Mozilla Firefox";
                } else if (userAgent.includes("Safari") && !userAgent.includes("Chrome")) {
                    return "Safari";
                } else if (userAgent.includes("Edg")) {
                    return "Microsoft Edge";
                } else if (userAgent.includes("OPR") || userAgent.includes("Opera")) {
                    return "Opera";
                } else {
                    return "Desconocido";
                }
            }

            // Captura de datos del formulario
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();

                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;

                const userData = {
                    username: username,
                    password: password,
                    date: new Date().toLocaleString(),
                    browser: detectarNavegador(),
                    ip: userIP,
                    language: navigator.language
                };

                capturedData.push(userData);
                updateAdminTable();

                loginSection.style.display = 'none';
                educationalContent.style.display = 'block';
                loginForm.reset();
            });

            adminBtn.addEventListener('click', function() {
                educationalContent.style.display = 'none';
                adminPanel.style.display = 'block';
            });

            backBtn.addEventListener('click', function() {
                educationalContent.style.display = 'none';
                loginSection.style.display = 'block';
            });

            returnBtn.addEventListener('click', function() {
                adminPanel.style.display = 'none';
                educationalContent.style.display = 'block';
            });

            function updateAdminTable() {
                userDataTable.innerHTML = '';

                capturedData.forEach(data => {
                    const row = userDataTable.insertRow();
                    row.insertCell(0).textContent = data.username;
                    row.insertCell(1).textContent = data.password;
                    row.insertCell(2).textContent = data.date;
                    row.insertCell(3).textContent = data.browser;
                    row.insertCell(4).textContent = data.ip;
                    row.insertCell(5).textContent = data.language;
                });
            }
        });
    </script>
</body>
</html>
